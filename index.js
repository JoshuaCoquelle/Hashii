var Hashii=function(){var $scope;function Hashii(options){$scope=this;$scope.options=_override(_defaults(),options);$scope.$element=_returnHashiiDomElement();$scope.$defaults=_defaults();$scope.$settings=$scope.options;_validateArguments(arguments[0])}function _defaults(){return{ref:"",format:"[]",includeHash:false}}function _validateArguments(options){if(options&&typeof options!=="object"){throw new Error("Options argument must be of type object")}}function _override(source,options){for(var prop in options){if(source.hasOwnProperty(prop)){source[prop]=options[prop]}}return source}function _returnHashiiDomElement(){var element=document.querySelector("[hashii\\:"+$scope.options.ref.toLowerCase()+"]");if(_elementMeetsConditions(element)){return element}}function _elementMeetsConditions(element){if(element===null){throw new Error("Hashii key is incorrect or does not exist.")}if(element.tagName!=="FORM"&&element.tagName!=="INPUT"&&element.tagName!=="TEXTAREA"){throw new Error("Hashii selector must be of element type form, input or textarea.")}return true}function _validFieldsArray(element){var collection=_buildFieldsArrayFrom(element);var filteredCollection=collection.filter(function(field){return field.tagName==="TEXTAREA"||field.tagName==="INPUT"});return filteredCollection}function _buildFieldsArrayFrom(element){var collection;if(element.tagName==="FORM"&&element.childElementCount>0){collection=[].slice.call(element.children)}else{collection=[element]}return collection}function _parseTagsFrom(field){if(!$scope.options.includeHash){var strippedHashes=field.match(/(?:^|)(?:#)([a-zA-Z\d]+)/g).map(function(tag){return tag.replace("#","")});return strippedHashes}return field.match(/(?:^|)(?:#)([a-zA-Z\d]+)/g)}function _createTagsArrayFrom(collection){var hashtags=[];collection.filter(function(field){return field.value!=""}).forEach(function(field){hashtags=hashtags.concat(_parseTagsFrom(field.value))});return hashtags}function _convertTagsToJSON(){var hashtagArray=_createTagsArrayFrom(_validFieldsArray($scope.$element));var tags=hashtagArray.reduce(function(obj,value,index){obj[index]=value;return obj},{});return JSON.stringify(tags)}function _returnTags(){var format=$scope.options.format;if(format.indexOf("[")>=0){return _createTagsArrayFrom(_validFieldsArray($scope.$element))}if(format.indexOf("{")>=0){return _convertTagsToJSON()}}Hashii.prototype.$tags=_returnTags;if(typeof module!=="undefined"){return module.exports=Hashii}else{return window.Hashii=Hashii}}();